<!-- Breadcrumb -->
<div
    class="breadcrumb-card mb-25 d-md-flex align-items-center justify-content-between"
>
    <h5 class="mb-0">نظام</h5>
    <ol class="breadcrumb list-unstyled mt-0 mb-0 pl-0">
        <li class="breadcrumb-item position-relative">
            <a routerlink="/setup" class="d-inline-block position-relative">
                <i class="ri-settings-line"></i>
                مشرف
            </a>
        </li>
        <li class="breadcrumb-item position-relative">نظام</li>
    </ol>
</div>

<mat-card
    class="daxa-card customers-card mb-25 border-radius bg-white border-none d-block"
    [class.rtl-enabled]="themeService.isRTLEnabled()"
>
    <mat-card-header>
        <mat-card-title>
            <form class="search-box position-relative">
                <i class="material-symbols-outlined"> search </i>
                <input
                    type="text"
                    class="input-search d-block w-100 border-none outline-0"
                    placeholder="Search..."
                    (keyup)="applyFilter($event)"
                    #input
                />
            </form>
        </mat-card-title>
        <mat-card-subtitle>
            <!-- <a mat-button class="add-new-btn"> اضافة نظام + </a> -->
            <app-dynamic-button
                label="اضافة نظام +"
                [buttonClass]="'daxa custom-class'"
                (onClick)="popupVisible = true"
            ></app-dynamic-button>
        </mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
        <div class="customers-table">
            <div class="table-responsive">
                <table mat-table [dataSource]="dataSource">
                    <ng-container
                        *ngFor="let col of displayedColumns"
                        [matColumnDef]="col.key"
                    >
                        <th
                            mat-header-cell
                            *matHeaderCellDef
                            [style.width]="col.width"
                            [ngClass]="{
                                'app-name-column':
                                    col.key === 'ApplicationNameAr'
                            }"
                        >
                            {{ col.header }}
                        </th>

                        <td
                            mat-cell
                            *matCellDef="let element"
                            [style.width]="col.width"
                            [ngClass]="{
                                'description-column':
                                    col.key === 'ApplicationNameEn',
                                'app-name-column':
                                    col.key === 'ApplicationNameAr'
                            }"
                        >
                            <ng-container
                                *ngIf="col.key !== 'action'; else actionTpl"
                            >
                                {{ element[col.key] }}
                            </ng-container>
                            <ng-template #actionTpl>
                                <div class="action-info">
                                    <a
                                        mat-button
                                        matTooltip="View"
                                        (click)="ViewData(element)"
                                    >
                                        <i class="material-symbols-outlined"
                                            >visibility</i
                                        >
                                    </a>
                                    <a
                                        mat-button
                                        matTooltip="Edit"
                                        (click)="onEdit(element)"
                                    >
                                        <i class="material-symbols-outlined"
                                            >edit</i
                                        >
                                    </a>
                                    <button
                                        mat-button
                                        matTooltip="Delete"
                                        (click)="onDelete(element)"
                                    >
                                        <i class="material-symbols-outlined"
                                            >delete</i
                                        >
                                    </button>
                                </div>
                            </ng-template>
                        </td>
                    </ng-container>

                    <tr
                        mat-header-row
                        *matHeaderRowDef="displayedColumnKeys"
                    ></tr>
                    <tr
                        mat-row
                        *matRowDef="let row; columns: displayedColumnKeys"
                    ></tr>

                    <tr class="mat-row" *matNoDataRow>
                        <td
                            class="mat-cell"
                            [attr.colspan]="displayedColumns.length"
                        >
                            No data matching the filter
                        </td>
                    </tr>
                </table>
            </div>
            <mat-paginator
                [pageSizeOptions]="[10, 20, 30]"
                showFirstLastButtons
            ></mat-paginator>
        </div>
    </mat-card-content>
</mat-card>

<app-dynamic-form-popup
    [title]="'Add/Edit Application'"
    [isActive]="popupVisible"
    [fields]="fields"
    (close)="popupVisible = false"
    [initialData]="initialData"
    (submitForm)="onAddEdit($event)"
></app-dynamic-form-popup>

<!-- View -->
<div
    class="create-new-popup"
    [class.active]="ViewclassApplied"
    [class.rtl-enabled]="themeService.isRTLEnabled()"
>
    <div class="popup-dialog">
        <mat-card
            class="daxa-card mb-25 border-radius bg-white border-none d-block"
        >
            <mat-card-header>
                <mat-card-title>
                    <h5 class="mt-0 mb-0">Screen Action Details</h5>
                </mat-card-title>
                <mat-card-subtitle>
                    <button mat-button (click)="toggleClassView()">
                        <i class="ri-close-fill"></i>
                    </button>
                </mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
                <!-- Half-width fields -->
                <div class="row">
                    <div class="col-md-12">
                        <label class="main-label d-block lh-1 text-black">
                            Name
                        </label>
                        <div class="readonly-display">
                            <span *ngIf="selectedRow?.ApplicationNameAr">
                                {{ selectedRow.ApplicationNameAr }}
                            </span>
                        </div>
                    </div>

                    <div class="col-md-12">
                        <label class="main-label d-block lh-1 text-black">
                            Description
                        </label>
                        <div class="readonly-display">
                            <span *ngIf="selectedRow?.ApplicationNameEn">
                                {{ selectedRow.ApplicationNameEn }}
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Close Button -->
                <div class="btn-box">
                    <button mat-button (click)="toggleClassView()">
                        Close
                    </button>
                </div>
            </mat-card-content>
        </mat-card>
    </div>
</div>
